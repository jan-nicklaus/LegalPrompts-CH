<!DOCTYPE html>
<html><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
        <title>Legal Prompt Builder</title>
        <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
        <link href="style.css" rel="stylesheet">
    </head>
    <body>
        <script type="text/javascript">
            document.addEventListener("alpine:init", () => {
                Alpine.data("state", () => ({
                    "task": "entscheid-zsfg",
                    "fields": {
                        "entscheid-zsfg": {
                            "display_name": "Entscheid zusammenfassen",
                            "prompt_base": "Fasse den folgenden Entscheid zusammen!",
                            "inputs": [
                                {
                                    "name": "fundstelle",
                                    "display_name": "Fundstelle",
                                    "type": "text",
                                    "value": ""
                                },
                                {
                                    "name": "rolle",
                                    "display_name": "Was ist Ihre Rolle?",
                                    "type": "text",
                                    "value": ""
                                }
                            ]
                        },
                        "task-zwei": {
                            "display_name": "Zweiter Task",
                            "prompt_base": "ErzÃ¤hle ein Gedicht auf der Basis folgender Informationen!",
                            "inputs": [
                                {
                                    "name": "fundstelle",
                                    "display_name": "Was ist deine Lieblingsfarbe?",
                                    "type": "text",
                                    "value": ""
                                },
                                {
                                    "name": "rolle",
                                    "display_name": "Was ist dein Lieblingstier?",
                                    "type": "text",
                                    "value": ""
                                }
                            ]
                        }
                    },
                    "promptComplete": "",
                    async getTaskSelectHTML() {
                        if(!this.task) return ""
                        console.log("test");
                        let options = Object.keys(this.fields).map(t => `<option value="${t}">${this.fields[t].display_name}</option>`).join("");
                        console.log(options);
                        return `<select x-bind:value="task" @change="e => task = e.target.value">
                                ${options}
                            </select>`
                    },
                    async getTaskFieldHTML() {
                        if(!this.task) return ""
                        let html = "";
                        this.fields[this.task].inputs.forEach(function (field, index) {
                            console.log(field, index)
                            html += `<div class="flex flex-row items-center"><p>${field.display_name}: </p><input type="${field.type}" class="border border-black m-2 rounded " x-bind:value="fields['entscheid-zsfg'].inputs[${index}].value" @change="e => fields['entscheid-zsfg'].inputs[${index}].value = e.target.value"/></div>`
                        });
                        return html;
                    },
                    async generatePrompt() {
                        let fields = this.fields[this.task].inputs.map(i => `${i.display_name}: ${i.value}`).join("\n")
                        this.promptComplete = `${this.fields[this.task].prompt_base}\n${fields}`;
                    }
                }))
            });
        </script>
        <div x-data="state" id="basediv" class="flex flex-col">
            <h1 class="text-2xl">Legal Prompt Builder v0.1</h1>
            <div x-html="getTaskSelectHTML"></div>
            <div x-html="getTaskFieldHTML"></div>
            <button class="border rounded border-black p-2" @click="generatePrompt">Prompt generieren</button>
            <textarea x-text="promptComplete" class="w-full h-20"></textarea>
        </div>
    
 </body></html>